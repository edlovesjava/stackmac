# Fibonacci Sequence - First 15 numbers
# Using iterative approach with simple stack management
# Stack layout: [counter, a, b] where a and b are consecutive Fibonacci numbers

# Print first two manually
PUSH 0
PRINT            # F(0) = 0

PUSH 1
PRINT            # F(1) = 1

# Initialize: counter=13, a=0, b=1
PUSH 13          # How many more to generate
PUSH 0           # a = F(n-2)
PUSH 1           # b = F(n-1)

LOOP:
  # Stack is: [counter, a, b]
  # Compute next = a + b and print it
  DUP            # [counter, a, b, b]
  ROT            # [counter, b, b, a]
  ADD            # [counter, b, next] where next = a + b
  DUP
  PRINT          # Print next

  # Now we have [counter, b, next]
  # For next iteration we need: [counter-1, b, next]
  # Which is: [counter-1, new_a, new_b]

  ROT            # [b, next, counter]
  PUSH 1
  SUB            # [b, next, counter-1]

  # Check if done
  DUP
  PUSH 0
  GT             # counter-1 > 0?
  JZ END

  # Rearrange to [counter-1, b, next]
  SWAP           # [b, counter-1, next]
  ROT            # [counter-1, next, b]
  SWAP           # [counter-1, b, next]

  JUMP LOOP

END:
  POP            # Remove counter
  POP            # Remove b
  POP            # Remove next
  HALT
